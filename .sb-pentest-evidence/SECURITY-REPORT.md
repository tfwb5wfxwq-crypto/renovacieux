# ğŸ”’ Rapport d'Audit SÃ©curitÃ© Supabase

**Application:** Renovacieux  
**URL:** https://renovacieux.com  
**Date:** 2026-02-03  
**Auditeur:** Claude Code + supabase-pentest-skills

---

## ğŸ“Š RÃ©sumÃ© ExÃ©cutif

| SÃ©vÃ©ritÃ© | TrouvÃ© | CorrigÃ© |
|----------|--------|---------|
| ğŸ”´ P0 (Critique) | 1 | âœ… |
| ğŸŸ  P1 (Ã‰levÃ©) | 0 | - |
| ğŸŸ¡ P2 (Moyen) | 0 | - |
| ğŸŸ¢ Info | 1 | - |

**Statut global: âœ… SÃ‰CURISÃ‰**

---

## ğŸ” RÃ©sultats DÃ©taillÃ©s

### 1. DÃ©tection Supabase
- **Projet:** ujfyvlkmsabinrfylzdr
- **RÃ©gion:** eu-central-1
- **URL:** https://ujfyvlkmsabinrfylzdr.supabase.co

### 2. ClÃ©s ExposÃ©es

| ClÃ© | Statut | SÃ©vÃ©ritÃ© |
|-----|--------|----------|
| Anon Key | ExposÃ©e (attendu) | ğŸŸ¢ INFO |
| Service Role Key | Non exposÃ©e | âœ… OK |
| JWT Secret | Non exposÃ© | âœ… OK |
| Database URL | Non exposÃ©e | âœ… OK |

### 3. AccÃ¨s API (Table `clients`)

| OpÃ©ration | RÃ´le Anon | RÃ´le Authenticated |
|-----------|-----------|-------------------|
| SELECT | âŒ BloquÃ© | âœ… AutorisÃ© |
| INSERT (direct) | âŒ BloquÃ© | âœ… AutorisÃ© |
| INSERT (RPC) | âœ… AutorisÃ© | âœ… AutorisÃ© |
| UPDATE | âŒ BloquÃ© | âœ… AutorisÃ© |
| DELETE | âŒ BloquÃ© | âœ… AutorisÃ© |

**RLS:** âœ… ActivÃ©  
**Policies:** `anon_insert`, `auth_all`  
**Fonction RPC:** `insert_client()` avec SECURITY DEFINER

### 4. Storage

- **Buckets publics:** Aucun
- **Statut:** âœ… OK

### 5. Configuration Auth

| ParamÃ¨tre | Valeur | Statut |
|-----------|--------|--------|
| Email signup | ActivÃ© | âœ… OK |
| Confirmation email | Requise | âœ… OK |
| Auto-confirm | DÃ©sactivÃ© | âœ… OK |
| Anonymous users | DÃ©sactivÃ© | âœ… OK |
| Social providers | Aucun | âœ… OK |

---

## ğŸ”´ VulnÃ©rabilitÃ© CorrigÃ©e

### P0: DonnÃ©es Clients ExposÃ©es Publiquement (CORRIGÃ‰)

**DÃ©couverte:** Les donnÃ©es clients (nom, email, tÃ©lÃ©phone) Ã©taient lisibles sans authentification via la clÃ© anon.

**Cause:** 5 policies RLS trop permissives (`insert_clients`, `select_clients`, `update_clients`, `delete_clients`, `allow_all`) avec `USING (true)` pour le rÃ´le `public`.

**Correction:**
1. Suppression des policies permissives
2. Activation RLS via Dashboard Supabase
3. CrÃ©ation de policies restrictives (`anon_insert`, `auth_all`)
4. CrÃ©ation fonction RPC `insert_client()` pour le formulaire contact

**VÃ©rification:** SELECT retourne `[]` pour le rÃ´le anon.

---

## âœ… Recommandations

1. **Monitoring:** Activer les logs Supabase pour surveiller les accÃ¨s
2. **Rate limiting:** Configurer des limites sur la fonction `insert_client()` pour Ã©viter le spam
3. **Backup:** S'assurer que les backups automatiques sont activÃ©s

---

## ğŸ“ Fichiers d'Evidence

```
.sb-pentest-evidence/
â”œâ”€â”€ 01-detection/detection.json
â”œâ”€â”€ 02-extraction/keys.json
â”œâ”€â”€ 03-api-audit/table-access.json
â”œâ”€â”€ 04-storage-audit/buckets.json
â”œâ”€â”€ 05-auth-audit/auth-config.json
â””â”€â”€ SECURITY-REPORT.md
```

---

*GÃ©nÃ©rÃ© avec supabase-pentest-skills*
